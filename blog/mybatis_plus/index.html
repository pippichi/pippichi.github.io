<!DOCTYPE html>
<html>
  <head>
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-12345678-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
  MyBatis_plus &ndash; Learning Records

    </title>
    
    <meta content="MyBatis" name="keywords">
    
    
    <meta name="description" property="og:description" content="对于MyBatis_plus的学习总结
|Just for record">
    

    <meta name="apple-mobile-web-app-title" content="Learning Records">
    
    
    
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
    <meta name="twitter:title" content="MyBatis_plus | Learning Records">
    <meta name="twitter:description" content="对于MyBatis_plus的学习总结|Just for record">
    <meta name="twitter:image" content="https://pippichi.github.iotwitter-card.png">
    


    <link rel="stylesheet" href="/assets/syntax.css">
    <link rel="stylesheet" href="/assets/primer-build.css">
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/custom_style.css">
  </head>


  <body class="bg-gray">
    <div id="holy" class="container-lg bg-white h-100">

      <div id="header" class="px-1 bg-white">
        <nav class="UnderlineNav UnderlineNav--right px-2">
  <a class="UnderlineNav-actions muted-link h2" href="https://pippichi.github.io">
    Learning Records
  </a>

  
  
  <div class="UnderlineNav-body">
    
    
    
    <a class="UnderlineNav-item" href="/blog/">
      
      <span>Home</span>
    </a>
    
    
    
    
    <a class="UnderlineNav-item" href="/">
      
      <span>PDF/CODE</span>
    </a>
    
    
    
    
    <a class="UnderlineNav-item" href="/about/">
      
      <span>About</span>
    </a>
    
    
  </div>
  
</nav>

      </div>

      <div role="main" id="main" class="holy-main markdown-body px-4 bg-white">
        

<div class="Subhead">
  <div class="Subhead-heading">
    <div class="h1 mt-3 mb-1">MyBatis_plus</div>
  </div>
  <div class="Subhead-description">
    


<a href='/categories/senior' class="muted-link">
  <span class="Label Label--gray-darker">Senior</span>
</a>



<a href='/tags/mybatis' class="muted-link">
  <span class="Label Label--gray">MyBatis</span>
</a>



    
    <div class="float-md-right">
      <span title="Lastmod: 2021-04-14. Published at: 2021-04-14.">
        
          Published: 2021-04-14
        
      </span>
    </div>
    
  </div>
</div>
<article>
  
  <section class="pb-6 mb-3 border-bottom">
    <p>对于MyBatis_plus的学习总结</p>
<h2 id="使用mybatis_plus">使用mybatis_plus</h2>
<p>首先由于mybatis_plus是在mybatis上的一层无侵入的封装，所以它是依赖mybatis的，因此需要导入所有mybatis相关的包</p>
<p>然后导入mybatis_plus的包</p>
<p>然后将mybatis的SqlSessionFactory替换成mybatis_plus的MybatisSqlSessionFactory即可（简单来讲就是替换一下工厂类即可）</p>
<p>之后就可以开始用了：</p>
<p>接口：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// BaseMapper&lt;Student&gt;中的Student告诉mybatis_plus如果要生成基础sql查询，请参考Student类及其属性
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">StudentMapper</span> <span class="kd">extends</span> <span class="n">BaseMapper</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;{}</span>
</code></pre></div><p>测试：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 获取String容器对象
</span><span class="c1"></span><span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;applicationcontext.xml&#34;</span><span class="o">);</span>
<span class="c1">// 获取StudentMapper接口的实例化对象
</span><span class="c1"></span><span class="n">StudentMapper</span> <span class="n">studentMapper</span> <span class="o">=</span> <span class="o">(</span><span class="n">StudentMapper</span><span class="o">)</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;studentMapper&#34;</span><span class="o">);</span>
<span class="c1">//// 查询
</span><span class="c1">// selectList方法：查询所有的学生信息
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">students</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="c1">// selectById方法：根据id查询
</span><span class="c1"></span><span class="n">Student</span> <span class="n">student</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="c1">// selectByMap方法：根据指定条件完成查询
</span><span class="c1"></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;s_name&#34;</span><span class="o">,</span> <span class="s">&#34;张三&#34;</span><span class="o">);</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;sage&#34;</span><span class="o">,</span> <span class="n">20</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectByMap</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
<span class="c1">// selectBatchIds方法：根据id集合查询数据
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">ids</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">ids</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectBatchIds</span><span class="o">(</span><span class="n">ids</span><span class="o">);</span>
<span class="c1">// 新增学生信息
</span><span class="c1"></span><span class="n">Student</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="n">s</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">s</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;qq&#34;</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
<span class="c1">// 修改学生信息
</span><span class="c1"></span><span class="n">Student</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="n">s1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">s1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;yy&#34;</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">updateById</span><span class="o">(</span><span class="n">s1</span><span class="o">);</span> <span class="c1">// 只更新有值的属性，null值的属性不参与更新
</span><span class="c1">//// 删除学生信息
</span><span class="c1">// deleteById方法：根据ID删除学生信息
</span><span class="c1"></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="c1">// deleteMap方法：根据指定字段完成数据删除
</span><span class="c1">// 注意：传入的map集合中存储了要删除的数据的键值对，键名为数据库中的字段的名称，而不是实体类的属性名
</span><span class="c1"></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;s_name&#34;</span><span class="o">,</span> <span class="s">&#34;赵六&#34;</span><span class="o">);</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;sage&#34;</span><span class="o">,</span> <span class="n">40</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">deleteByMap</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
<span class="c1">// deleteBatchIds方法：多选删除，将符合ID要求的数据全部删除
</span><span class="c1">// 参数：存储了要删除的数据的id的集合
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">ids</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">ids</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">deleteBatchIds</span><span class="o">(</span><span class="n">ids</span><span class="o">);</span>
</code></pre></div><h2 id="mybatis-plus配置文件详解">Mybatis-Plus配置文件详解</h2>
<p>参考：https://blog.csdn.net/Huang_ZX_259/article/details/122562231（MyBatis-Plus——超详细讲解配置文件）</p>
<h2 id="注解">注解</h2>
<h3 id="tablenametableid与tablefield">@TableName、@TableId与@TableField</h3>
<p>由于mybatis_plus是根据实体类来反向推测可能用到的sql查询从而免去我们手动写基本sql查询的，而有时候实体类类名或属性和数据库表名或字段名不一定对的上，这个时候就需要用@TableName(&ldquo;表名&rdquo;)和@TableField(&ldquo;字段名&rdquo;)的方式来指定了</p>
<p>@TableId是在实体类对应的主键属性上使用的，用来表明该属性是主键，并且需要说明主键的设置类型，比如：自增。</p>
<p>而且加了@TableId这个注解之后可以实现主键回填（那么为什么不加的时候新增还是可以做到数据库表中的主键自增，但是回填的时候实体类的主键还是为null呢？那是因为新增的时候mbp一看实体类有个属性跟数据库表的主键对上了，那就会判定这个属性就是主键，那就会正常生成记录并自增主键，但是回填的时候它没法判断谁是主键，因此没法回填主键）</p>
<p>其他注解及属性请看mybatis_plus官方文档</p>
<p>需要注意的是@TableField注解有一个属性叫exist，它可以用来排除实体类字段。我们知道mp默认实体类所有属性都对应到数据表的字段，但是有些属性是不存在于数据表的（或者说是我们自己加的属性，但是不希望mp把它当成数据表的某个字段），此时就可以这么用：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@TableField</span><span class="o">(</span><span class="n">exist</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">customid</span><span class="o">;</span>
</code></pre></div><h2 id="wrapper条件构造器">Wrapper条件构造器</h2>
<p>用于完成复杂sql</p>
<p>具体实现类：QueryWrapper</p>
<p>举例：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*
</span><span class="cm">* 条件构造器是以Java对象的形式将数据操作的筛选条件描述出来，然后由mp将其翻译成对应的sql判断并拼接在sql语句上
</span><span class="cm">*/</span>
<span class="c1">// 获取String容器对象
</span><span class="c1"></span><span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;applicationcontext.xml&#34;</span><span class="o">);</span>
<span class="c1">// 获取StudentMapper接口的实例化对象
</span><span class="c1"></span><span class="n">StudentMapper</span> <span class="n">studentMapper</span> <span class="o">=</span> <span class="o">(</span><span class="n">StudentMapper</span><span class="o">)</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;studentMapper&#34;</span><span class="o">);</span>
<span class="c1">// 创建条件构造器对象
</span><span class="c1"></span><span class="n">QueryWrapper</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">queryWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QueryWrapper</span><span class="o">&lt;&gt;();</span>
<span class="c1">// queryWrapper.eq(&#34;sage&#34;, 20);
</span><span class="c1">// queryWrapper.or();
</span><span class="c1">// queryWrapper.eq(&#34;s_name&#34;, &#34;张三&#34;);
</span><span class="c1">// 或者可以这么写：
</span><span class="c1"></span><span class="n">queryWrapper</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">&#34;sage&#34;</span><span class="o">,</span> <span class="n">29</span><span class="o">).</span><span class="na">or</span><span class="o">().</span><span class="na">eq</span><span class="o">(</span><span class="s">&#34;s_name&#34;</span><span class="o">,</span> <span class="s">&#34;张三&#34;</span><span class="o">);</span>
<span class="c1">// 根据条件查询数据
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">stds</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="n">queryWrapper</span><span class="o">);</span> <span class="c1">// 同理增删改，具体看文档
</span></code></pre></div><h2 id="分页器配置">分页器配置</h2>
<p>可以在Spring的applicationcontext.xml配置文件中配置：</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置工厂bean--&gt;</span>
<span class="c">&lt;!--配置了这个bean意味着mp的SqlSessionFactory就会变成这个bean，后续的sql操作要用到的SqlSession就会通过它来实例化--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;factory&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--配置mp分页插件--&gt;</span>
    <span class="c">&lt;!--下面的标签（property、array、bean）表示它是一个数组属性，属性名为plugins，数组里面装了bean--&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;plugins&#34;</span><span class="nt">&gt;</span>
    	<span class="nt">&lt;array&gt;</span>
        	<span class="c">&lt;!--配置分页插件：拦截对象--&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;page&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor&#34;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--value=&#34;mysql&#34;表示指定方言为mysql，指明要进行分页操作的数据库--&gt;</span>
            	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dialectType&#34;</span> <span class="na">value=</span><span class="s">&#34;mysql&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
            <span class="nt">&lt;/bean&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><p>测试：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 获取String容器对象
</span><span class="c1"></span><span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;applicationcontext.xml&#34;</span><span class="o">);</span>
<span class="c1">// 获取StudentMapper接口的实例化对象
</span><span class="c1"></span><span class="n">StudentMapper</span> <span class="n">studentMapper</span> <span class="o">=</span> <span class="o">(</span><span class="n">StudentMapper</span><span class="o">)</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;studentMapper&#34;</span><span class="o">);</span>
<span class="c1">// 创建Page对象封装分页查询条件
</span><span class="c1"></span><span class="n">IPage</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Page</span><span class="o">&lt;&gt;(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
<span class="c1">// 查询
</span><span class="c1"></span><span class="n">IPage</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">studentIPage</span> <span class="o">=</span> <span class="n">studentMapper</span><span class="o">.</span><span class="na">selectPage</span><span class="o">(</span><span class="n">page</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="c1">// 分页查询结果
</span><span class="c1"></span><span class="n">studentIPage</span><span class="o">.</span><span class="na">getRecords</span><span class="o">();</span>
<span class="c1">// 分页总共的数据量
</span><span class="c1"></span><span class="n">studentIPage</span><span class="o">.</span><span class="na">getTotal</span><span class="o">();</span>
<span class="c1">// 分页总共的页码量
</span><span class="c1"></span><span class="n">studentIPage</span><span class="o">.</span><span class="na">getPages</span><span class="o">();</span>
<span class="c1">// 其他还有很多方法...
</span></code></pre></div><h2 id="全局配置策略">全局配置策略</h2>
<p>场景：</p>
<p>​	假如我们每个实体类和数据库中的表名都不一致，表的格式都是t_表名，但是类名没有t_前缀，比如t_student表和Student类。这样每个实体类上我们都要使用@TableName注解来表明类和表的映射关系，很麻烦</p>
<p>解决：</p>
<p>​	使用MP的全局配置策略。GlobalConfig</p>
<p>作用：</p>
<p>​	配置表和类名映射关系的前缀</p>
<p>​	配置全局主键自增</p>
<p>进入MybatisSqlSessionFactoryBean.java文件我们会发现它有一个属性：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">GlobalConfig</span> <span class="n">globalConfig</span><span class="o">;</span>
</code></pre></div><p>那么事实上我们就是需要配置并注入这个属性</p>
<p>配置示例：</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置mp的全局策略--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;globalConfig&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.core.config.GlobalConfig&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--配置数据库全局默认的映射关系--&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dbConfig&#34;</span><span class="nt">&gt;</span>
    	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dbConfig&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.core.config.GlobalConfig$DbConfig&#34;</span><span class="nt">&gt;</span>
        	<span class="c">&lt;!--声明全局默认类名的对应的表的前缀--&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;tablePrefix&#34;</span> <span class="na">value=</span>
<span class="s">&#34;t_&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
            <span class="c">&lt;!--配置全局主键自增--&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;idType&#34;</span> <span class="na">value=</span><span class="s">&#34;AUTO&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><p>配完上面的配置后，再将上面的配置注入MybatisSqlSessionFactoryBean：</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置工厂bean--&gt;</span>
<span class="c">&lt;!--配置了这个bean意味着mp的SqlSessionFactory就会变成这个bean，后续的sql操作要用到的SqlSession就会通过它来实例化--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;factory&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
    
    
    <span class="c">&lt;!--配置全局策略--&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;globalConfig&#34;</span> <span class="na">ref=</span><span class="s">&#34;globalConfig&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
    
    
	<span class="c">&lt;!--配置mp分页插件--&gt;</span>
    <span class="c">&lt;!--下面的标签（property、array、bean）表示它是一个数组属性，属性名为plugins，数组里面装了bean--&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;plugins&#34;</span><span class="nt">&gt;</span>
    	<span class="nt">&lt;array&gt;</span>
        	<span class="c">&lt;!--配置分页插件：拦截对象--&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;page&#34;</span> <span class="na">class=</span><span class="s">&#34;com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor&#34;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--value=&#34;mysql&#34;表示指定方言为mysql，指明要进行分页操作的数据库--&gt;</span>
            	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dialectType&#34;</span> <span class="na">value=</span><span class="s">&#34;mysql&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
            <span class="nt">&lt;/bean&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><p>这样我们就不需要给每个实体类都加上t_前缀了（换句话说实体类上的@TableName(&ldquo;t_xxx&rdquo;)就不需要了）</p>
<p>而且我们还设置了默认主键自增，因此@TableId(type=IdType.AUTO)中的type属性也不需要写了，也就是说只需要写@TableId就行了</p>
<h2 id="mybatis-plus-处理器">Mybatis Plus 处理器</h2>
<p>有诸如<code>MetaObjectHandler</code>等，可以参考张润华的<a href="https://github.com/pippichi/work/tree/master/zk/%E9%80%9A%E7%94%A8%E4%BC%98%E5%8C%96%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/base/supcon-parent"><code>supcon-parent</code></a>或者网络资料</p>
<h2 id="mybatis-plus-sql注入器sqlinjector">MyBatis Plus SQL注入器（SqlInjector）</h2>
<p>参考：</p>
<p><a href="https://blog.csdn.net/qq_44824164/article/details/140081872">https://blog.csdn.net/qq_44824164/article/details/140081872</a>（【第24章】MyBatis-Plus之SQL注入器）</p>
<p><a href="https://www.jb51.net/program/320701w60.htm">https://www.jb51.net/program/320701w60.htm</a>（MybatisPlus更新为null的字段及自定义sql注入）</p>
<p><a href="https://blog.csdn.net/qq_42472539/article/details/135859158">https://blog.csdn.net/qq_42472539/article/details/135859158</a>（【MybatisPlus深入使用指南】mybatisplus创建自定义方法sql注入器，批量操作详细（涵盖主键生成））</p>
<h2 id="ar模式">AR模式</h2>
<p>AR模式中不需要再获取Mapper对象，然后再将实体类传入给mapper层完成数据库操作，直接使用实体类即可完成操作（pojo实体类就会有增删改查功能），提高开发效率（其实实体类调用的增删改查底层还是在调用mapper，而且这个mapper我们还是得创建，不然它找不到）</p>
<p>使用示例：</p>
<p>pojo文件：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="kd">extends</span> <span class="n">Model</span><span class="o">{</span>
    <span class="nd">@TableId</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sid</span><span class="o">;</span>
    <span class="nd">@TableField</span><span class="o">(</span><span class="s">&#34;s_name&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sname</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sage</span><span class="o">;</span>
    <span class="o">...</span>
    <span class="c1">// 重写pkVal方法，注意这一步是必须要做的
</span><span class="c1"></span>    <span class="nd">@Override</span>
   	<span class="kd">protected</span> <span class="n">Serializable</span> <span class="nf">pkVal</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">sid</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>mapper接口：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">StudentMapper</span> <span class="kd">extends</span> <span class="n">BaseMapper</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;{</span>
<span class="o">}</span>
</code></pre></div><p>测试文件：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 测试AR模式
</span><span class="c1">// 获取Spring容器类对象
</span><span class="c1"></span><span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;application.xml&#34;</span><span class="o">);</span>
<span class="c1">// 获取Student的实体类对象
</span><span class="c1"></span><span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="c1">// 使用AR模式操作数据库
</span><span class="c1">//// AR查询
</span><span class="c1">// 查询所有
</span><span class="c1"></span><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="n">stu</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
<span class="c1">// 根据ID查询
</span><span class="c1">// 方式一
</span><span class="c1"></span><span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="o">(</span><span class="n">Student</span><span class="o">)</span><span class="n">stu</span><span class="o">.</span><span class="na">selectById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="c1">// 方式二
</span><span class="c1"></span><span class="n">stu</span><span class="o">.</span><span class="na">setSid</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="o">(</span><span class="n">Student</span><span class="o">)</span><span class="n">stu</span><span class="o">.</span><span class="na">selectById</span><span class="o">();</span>
<span class="c1">// 其他的增删改可以自行测试，唯一要注意的是原先使用mp的时候比方说增加，可能是这么写的：xxx.insert(stu);但是现在的话它实体类本身就是有属性的，可以直接这么写：stu.insert();
</span><span class="c1"></span>
<span class="c1">//// AR新增
</span><span class="c1"></span><span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="n">stu</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">11</span><span class="o">);</span>
<span class="n">stu</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;qq&#34;</span><span class="o">);</span>
<span class="kt">boolean</span> <span class="n">i</span> <span class="o">=</span> <span class="n">stu</span><span class="o">.</span><span class="na">insert</span><span class="o">();</span>

<span class="c1">//// AR更新
</span><span class="c1"></span><span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="n">stu</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">stu</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;yy&#34;</span><span class="o">);</span>
<span class="kt">boolean</span> <span class="n">i</span> <span class="o">=</span> <span class="n">stu</span><span class="o">.</span><span class="na">updateById</span><span class="o">();</span>

<span class="c1">//// AR删除
</span><span class="c1"></span><span class="n">Student</span> <span class="n">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
<span class="n">stu</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="kt">boolean</span> <span class="n">i</span> <span class="o">=</span> <span class="n">stu</span><span class="o">.</span><span class="na">deleteById</span><span class="o">();</span>

<span class="c1">// 还有update(Wrapper queryWrapper)、delete(Wrapper queryWrapper)等方法（条件更新、条件删除等），具体的去看文档
</span></code></pre></div><h2 id="mbp代码生成器">mbp代码生成器</h2>
<p>作用：根据数据库中的表动态生成表对应的mapper，service，pojo，controller层的基础代码，提升开发效率</p>
<p>1、导入代码生成器相关jar包</p>
<p><img src="/mybatis_plus.assets/image-20210414223311600.png" alt="image-20210414223311600"></p>
<p>2、直接运行下面的代码就好了</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCode</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 代码生成器
</span><span class="c1"></span>            <span class="n">AutoGenerator</span> <span class="n">mpg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AutoGenerator</span><span class="o">();</span>
        <span class="c1">//全局配置策略
</span><span class="c1"></span>            <span class="n">GlobalConfig</span> <span class="n">gc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GlobalConfig</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;user.dir&#34;</span><span class="o">);</span><span class="c1">//动态获取当前项目的路径
</span><span class="c1"></span>            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
            <span class="n">gc</span><span class="o">.</span><span class="na">setFileOverride</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">// 是否覆盖同名文件，默认是false
</span><span class="c1"></span>            <span class="n">gc</span><span class="o">.</span><span class="na">setActiveRecord</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span><span class="c1">// 不需要ActiveRecord特性的请改为false
</span><span class="c1"></span>            <span class="n">gc</span><span class="o">.</span><span class="na">setEnableCache</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">// XML 二级缓存
</span><span class="c1"></span>            <span class="n">gc</span><span class="o">.</span><span class="na">setBaseResultMap</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span><span class="c1">// XML ResultMap
</span><span class="c1"></span>            <span class="n">gc</span><span class="o">.</span><span class="na">setBaseColumnList</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">// XML columList
</span><span class="c1"></span>            <span class="n">gc</span><span class="o">.</span><span class="na">setOutputDir</span><span class="o">(</span><span class="n">path</span><span class="o">+</span><span class="s">&#34;/09-mp-code/src&#34;</span><span class="o">);</span>
            <span class="n">gc</span><span class="o">.</span><span class="na">setIdType</span><span class="o">(</span><span class="n">IdType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">);</span><span class="c1">//设置主键策略
</span><span class="c1"></span>
        <span class="c1">//数据源配置
</span><span class="c1"></span>            <span class="n">DataSourceConfig</span> <span class="n">dsc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataSourceConfig</span><span class="o">();</span>
            <span class="n">dsc</span><span class="o">.</span><span class="na">setUrl</span><span class="o">(</span><span class="s">&#34;jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&#34;</span><span class="o">);</span>
            <span class="c1">// dsc.setSchemaName(&#34;public&#34;);
</span><span class="c1"></span>            <span class="n">dsc</span><span class="o">.</span><span class="na">setDriverName</span><span class="o">(</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="o">);</span>
            <span class="n">dsc</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;root&#34;</span><span class="o">);</span>
            <span class="n">dsc</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&#34;1234&#34;</span><span class="o">);</span>

        <span class="c1">// 包配置
</span><span class="c1"></span>            <span class="n">PackageConfig</span> <span class="n">pc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PackageConfig</span><span class="o">();</span>
            <span class="n">pc</span><span class="o">.</span><span class="na">setParent</span><span class="o">(</span><span class="s">&#34;com.bjsxt&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setMapper</span><span class="o">(</span><span class="s">&#34;mapper&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setService</span><span class="o">(</span><span class="s">&#34;service&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setController</span><span class="o">(</span><span class="s">&#34;controller&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="s">&#34;pojo&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setXml</span><span class="o">(</span><span class="s">&#34;mapper&#34;</span><span class="o">);</span>
        <span class="c1">//策略配置
</span><span class="c1"></span>            <span class="n">StrategyConfig</span> <span class="n">stConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StrategyConfig</span><span class="o">();</span>
            <span class="n">stConfig</span><span class="o">.</span><span class="na">setCapitalMode</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="c1">//全局大写命名
</span><span class="c1"></span>                    <span class="o">.</span><span class="na">setNaming</span><span class="o">(</span><span class="n">NamingStrategy</span><span class="o">.</span><span class="na">underline_to_camel</span><span class="o">)</span> <span class="c1">// 数据库表映射到实体的命名策略
</span><span class="c1"></span>                    <span class="o">.</span><span class="na">setTablePrefix</span><span class="o">(</span><span class="s">&#34;t_&#34;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setInclude</span><span class="o">(</span><span class="s">&#34;t_student&#34;</span><span class="o">);</span> <span class="c1">// 生成的表，多个表继续传递即可，String类型的可变参数
</span><span class="c1"></span>
        <span class="c1">//将策略配置对象集成到代码生成器中
</span><span class="c1"></span>            <span class="n">mpg</span><span class="o">.</span><span class="na">setGlobalConfig</span><span class="o">(</span><span class="n">gc</span><span class="o">);</span>
            <span class="n">mpg</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">dsc</span><span class="o">);</span>
            <span class="n">mpg</span><span class="o">.</span><span class="na">setPackageInfo</span><span class="o">(</span><span class="n">pc</span><span class="o">);</span>
            <span class="n">mpg</span><span class="o">.</span><span class="na">setStrategy</span><span class="o">(</span><span class="n">stConfig</span><span class="o">);</span>
            <span class="c1">//执行生成
</span><span class="c1"></span>            <span class="n">mpg</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p><strong>自定义代码模板</strong></p>
<p>mbp默认是提供代码模板的，但有时候默认的模板比较简单，无法满足实际需要，这个时候就需要自己定义代码模板</p>
<p>mbp自带的默认模板：</p>
<p><img src="/mybatis_plus.assets/image-20220812201003465.png" alt="image-20220812201003465"></p>
<p>自定义模板请参考：<a href="https://github.com/pippichi/work/tree/master/zk/%E9%80%9A%E7%94%A8%E4%BC%98%E5%8C%96%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/base/supcon-parent">张润华<code>generator-spring-boot-starter</code>项目</a></p>
<h2 id="mybatis-plus动态数据源配置">Mybatis-plus动态数据源配置</h2>
<p>参考：https://www.cnblogs.com/zhaww/p/12706941.html（mybatis-plus动态数据源配置）</p>
<h2 id="插件">插件</h2>
<h3 id="多表插件mybatis-plus-join">多表插件<code>mybatis-plus-join</code></h3>
<p>参考：https://blog.csdn.net/mahuibo123/article/details/125886063（<code>mybatis-plus-join mybatis-plus</code>必备神器）、https://blog.csdn.net/weixin_39555954/article/details/128217887（<code>Mybatis-plus-join</code>连表查询）</p>
<h3 id="lombok插件">lombok插件</h3>
<p>用了Lombok注解之后，虽然看似Java代码中没写setter、getter等方法了，但其实等它被编译成.class文件之后，setter、getter等方法还是会在的，而且该.class文件跟不加LomBok注解之前的Java文件编译成的.class文件是一样的</p>
<p>如果idea要用的话需要先下载一个lombok插件，因为在idea中写的Java代码是由idea去编译的，而idea不支持也不认识lombok，所以要先下个lombok插件：</p>
<p><img src="/mybatis_plus.assets/image-20210414225652834.png" alt="image-20210414225652834"></p>
<p>然后还要开启idea的注解处理：</p>
<p><img src="/mybatis_plus.assets/image-20210414225927823.png" alt="image-20210414225927823"></p>
<p>之后就能用了：</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="c1">// @Getter
</span><span class="c1">// @Setter
</span><span class="c1">// @ToString
</span><span class="c1"></span><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sid</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sname</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">fav</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><p><img src="/mybatis_plus.assets/image-20210414230148156.png" alt="image-20210414230148156"></p>
<p><img src="/mybatis_plus.assets/image-20210414230110724.png" alt="image-20210414230110724"></p>
<h3 id="mybatisx插件">MybatisX插件</h3>
<p>MybatisX 是一款基于 IDEA 的快速开发插件，为效率而生。安装方法：打开 IDEA，进入 File -&gt; Settings -&gt; Plugins -&gt; Browse Repositories，输入 <code>mybatisx</code> 搜索并安装。</p>
<ul>
<li>Java与mapper.xml来回跳转</li>
<li>Mapper方法自动生成XML</li>
</ul>
  </section>

  <section>
    
      
    
  </section>
</article>

      </div>

      <div id="side" class="pr-1 bg-white">
        <aside class="pr-3">
          
  
    <div id="toc" class="Box Box--blue mb-3">
      <b>MyBatis_plus</b><nav id="TableOfContents">
  <ul>
    <li><a href="#使用mybatis_plus">使用mybatis_plus</a></li>
    <li><a href="#mybatis-plus配置文件详解">Mybatis-Plus配置文件详解</a></li>
    <li><a href="#注解">注解</a>
      <ul>
        <li><a href="#tablenametableid与tablefield">@TableName、@TableId与@TableField</a></li>
      </ul>
    </li>
    <li><a href="#wrapper条件构造器">Wrapper条件构造器</a></li>
    <li><a href="#分页器配置">分页器配置</a></li>
    <li><a href="#全局配置策略">全局配置策略</a></li>
    <li><a href="#mybatis-plus-处理器">Mybatis Plus 处理器</a></li>
    <li><a href="#mybatis-plus-sql注入器sqlinjector">MyBatis Plus SQL注入器（SqlInjector）</a></li>
    <li><a href="#ar模式">AR模式</a></li>
    <li><a href="#mbp代码生成器">mbp代码生成器</a></li>
    <li><a href="#mybatis-plus动态数据源配置">Mybatis-plus动态数据源配置</a></li>
    <li><a href="#插件">插件</a>
      <ul>
        <li><a href="#多表插件mybatis-plus-join">多表插件<code>mybatis-plus-join</code></a></li>
        <li><a href="#lombok插件">lombok插件</a></li>
        <li><a href="#mybatisx插件">MybatisX插件</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
  

  
    <div>
      
    </div>
  

        </aside>
      </div>

      <div id="footer" class="pt-2 pb-3 bg-white text-center">
        

  <span class="text-small text-gray">
    ©QYF Just for record 2018-2021 &middot; 

    Powered by the
    <a href="https://github.com/qqhann/hugo-primer" class="link-gray-dark">Hugo-Primer</a> theme for
    <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>.
  </span>


      </div>
    </div>

    
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>
    
  </body>
</html>
